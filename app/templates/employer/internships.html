{% extends "employer/employer_base.html" %}
{% block title %}企业首页{% endblock %}
{% block dashboard_content %}
<div class="content-container">
    <div class="page-header">
        <h1 class="page-title">我的实习岗位</h1>
        <a href="{{ url_for('employer.new_internship') }}" class="btn-primary">
            <i class="fas fa-plus"></i> 发布新实习
        </a>
    </div>

    <!-- 筛选面板 -->
    <div class="filter-panel">
        <div class="filter-header">
            <h5>筛选实习岗位</h5>
            <span>共 {{ total_records }} 个岗位</span>
        </div>

        <form class="filter-form" method="GET" action="{{ url_for('employer.internships') }}">
            <div class="form-group">
                <label for="search">职位名称</label>
                <input type="text" class="form-control" id="search" name="search"
                       value="{{ search_query }}" placeholder="输入职位名称...">
            </div>

            <div class="form-group">
                <label for="status">状态</label>
                <select class="form-select" id="status" name="status">
                    <option value="">所有状态</option>
                    <option value="active" {% if status_filter == 'active' %}selected{% endif %}>进行中</option>
                    <option value="expired" {% if status_filter == 'expired' %}selected{% endif %}>已结束</option>
                </select>
            </div>

            <div class="form-group">
                <label>&nbsp;</label>
                <button type="submit" class="btn-filter">
                    <i class="fas fa-filter"></i> 筛选
                </button>
            </div>
        </form>
    </div>

    <!-- 实习列表 -->
    <div class="internships-list">
        {% if internships %}
            <div class="row">
                {% for internship in internships %}
                <div class="col-md-6 mb-4">
                    <div class="internship-card">
                        <div class="internship-header">
                            <div>
                                <h3 class="internship-title">{{ internship.title }}</h3>
                                <p class="company-name">{{ company.company_name }}</p>
                            </div>
                            <span class="deadline {% if internship.status == 'expired' %}urgent{% endif %}">
                                <i class="fas fa-clock"></i> 截止: {{ internship.deadline.strftime('%Y-%m-%d') }}
                            </span>
                        </div>

                        <div class="internship-meta">
                            <div class="meta-item">
                                <i class="fas fa-map-marker-alt"></i> {{ internship.location }}
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-clock"></i> {{ internship.duration }}
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-user-friends"></i> {{ internship.number_of_opening }} 个名额
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-id-badge"></i> 职位ID: I{{ internship.internship_id }}
                            </div>
                        </div>

                        <div class="skills">
                            {% for skill in internship.skills_required.split(',') %}
                            <span class="skill-tag">{{ skill.strip() }}</span>
                            {% endfor %}
                        </div>

                        <p>{{ internship.description[:150] }}...</p>

                        <div class="card-footer">
                            <div class="stipend">薪资: {{ internship.stipend }}</div>
                            <a href="{{ url_for('employer.internship_detail', internship_id=internship.internship_id) }}"
                               class="btn-view">
                                <i class="fas fa-eye"></i> 查看详情
                            </a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- 分页 -->
            {% if total_pages > 1 %}
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-center">
                    {% if page > 1 %}
                    <li class="page-item">
                        <a class="page-link" href="{{ url_for('employer.internships', page=page-1, search=search_query, status=status_filter) }}">
                            <i class="fas fa-chevron-left"></i>
                        </a>
                    </li>
                    {% endif %}

                    {% for p in range(1, total_pages+1) %}
                    <li class="page-item {% if p == page %}active{% endif %}">
                        <a class="page-link" href="{{ url_for('employer.internships', page=p, search=search_query, status=status_filter) }}">{{ p }}</a>
                    </li>
                    {% endfor %}

                    {% if page < total_pages %}
                    <li class="page-item">
                        <a class="page-link" href="{{ url_for('employer.internships', page=page+1, search=search_query, status=status_filter) }}">
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </li>
                    {% endif %}
                </ul>
            </nav>
            {% endif %}

        {% else %}
            <div class="empty-state">
                <i class="fas fa-briefcase"></i>
                <h5>暂无实习岗位</h5>
                <p>您尚未发布任何实习岗位，点击"发布新实习"按钮创建您的第一个实习岗位</p>
                <a href="{{ url_for('employer.new_internship') }}" class="btn-primary">发布新实习</a>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}